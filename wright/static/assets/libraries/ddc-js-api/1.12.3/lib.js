var _____WB$wombat$assign$function_____=function(name){return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name))||self[name];};if(!self.__WB_pmw){self.__WB_pmw=function(obj){this.__WB_source=obj;return this;}}{
let window = _____WB$wombat$assign$function_____("window");
let self = _____WB$wombat$assign$function_____("self");
let document = _____WB$wombat$assign$function_____("document");
let location = _____WB$wombat$assign$function_____("location");
let top = _____WB$wombat$assign$function_____("top");
let parent = _____WB$wombat$assign$function_____("parent");
let frames = _____WB$wombat$assign$function_____("frames");
let opens = _____WB$wombat$assign$function_____("opens");
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";const e=e=>{let t=e;return t=t.replace(/^(tps-)/,""),t=t.replace(/^(cst-parse-)/,""),t=t.replace(/^(cst-)/,""),t=t.replace(/^(cw-)/,""),t},t=e=>{if(!e)return"Undefined";const t=["Web Integration API","Third Party Services API Full","Third Party Services API Compatible","Third Party Services API Hybrid","Third Party Services Velocity","Custom Work (cms-sites)"];return t.includes(e)?e:"wise"===e.toLowerCase()?t[0]:"api"===e.toLowerCase()?t[1]:"api_compatible"===e.toLowerCase()?t[2]:"hybrid"===e.toLowerCase()||e.startsWith("tps")?t[3]:"legacy"===e.toLowerCase()?t[4]:"custom"===e.toLowerCase()||e.startsWith("cw")||e.startsWith("cst")?t[5]:"Undefined"},i=e=>e&&"0"!==e&&"PLEASE_CALL"!==e&&parseInt(("number"==typeof e?String(e):e).replace(" ","").replace("Â ","").replace("$","").replace(",","").trim(),10)||0,n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",i=e.toLowerCase();i=i.split(t);for(let e=0;e<i.length;e++)i[e]=i[e].charAt(0).toUpperCase()+i[e].slice(1);return i.join(" ")},a="data-location",o="Insert",r="Insert Call To Action",s="Modify Call To Action",l="Modify Links On Page",d="primary-banner",c="Restrictively Modify Call To Action",u="Update",h="vehicle-badge",p="vehicle-ctas",g="vehicle-media",m="vehicle-payments",v="vehicle-pricing",y=`${h}-custom`,w=`${p}-custom`,f=`${g}-custom`,b=`${m}-custom`,P=`${v}-custom`,C=["mywallet","toyota-smartpath-banners"],I=["cox-dr-sales-checkin"],D=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15e3;return new Promise(((i,n)=>{const a=document.querySelector(e);if(a)return i(a);let o;const r=setTimeout((()=>{o&&o.disconnect(),n(new Error(`Element with selector "${e}" not found within ${t}ms`))}),t);o=new MutationObserver(((t,n)=>{const a=document.querySelector(e);a&&(clearTimeout(r),n.disconnect(),i(a))})),o.observe(document.documentElement,{childList:!0,subtree:!0})}))},E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t="mobile-navbar/open",i=[".ddc-mobile-fragment-nav",'[data-location~="primary-menu"]'];return new Promise((n=>{if((()=>{var e;const t=null===(e=document.querySelector(".ddc-document"))||void 0===e?void 0:e.classList;return null==t?void 0:t.contains("active")})())Promise.race(i.map((e=>D(e,1e4)))).then((()=>n(!0))).catch((()=>n(!1)));else{var a;if(null===(a=window.DDC)||void 0===a||null===(a=a.pubsub)||void 0===a||!a.subscribe)return void n(!1);let o;const r=async()=>{o&&clearTimeout(o),Promise.race(i.map((e=>D(e,1e4)))).then((()=>{var e;n(!0),null===(e=window.DDC)||void 0===e||null===(e=e.pubsub)||void 0===e||e.unsubscribe(t,r)})).catch((()=>n(!1)))};e&&(o=setTimeout((()=>{var e;null===(e=window.DDC)||void 0===e||null===(e=e.pubsub)||void 0===e||e.unsubscribe(t,r),n(!1)}),e)),window.DDC.pubsub.subscribe(t,r)}}))},A=()=>new Promise((e=>{"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e,{once:!0})})),L=async()=>{var e,t,i;return t=null===(e=window.DDC)||void 0===e||null===(e=e.PrivateAPI)||void 0===e?void 0:e.integrationsLoaded,i="WIAPILoaded",new Promise((e=>{!1!==t&&void 0!==t?e(t):window.addEventListener(i,(t=>{e(t)}),{once:!0})}))},T=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return new Promise(((n,a)=>{let o;const r=setTimeout((()=>{var t,n;((null===(t=window)||void 0===t?void 0:t.clearInterval)||(null===(n=global)||void 0===n?void 0:n.clearInterval)||(()=>{}))(o),a(new Error(`Timed out after ${i}ms waiting for ${e} to become available`))}),i);o=setInterval((()=>{var t,i,a,s;const l=e.split(".");let d=window;l.every((e=>void 0!==d[e]&&(d=d[e],!0)))&&(((null===(t=window)||void 0===t?void 0:t.clearInterval)||(null===(i=global)||void 0===i?void 0:i.clearInterval)||(()=>{}))(o),((null===(a=window)||void 0===a?void 0:a.clearTimeout)||(null===(s=global)||void 0===s?void 0:s.clearTimeout)||(()=>{}))(r),n(!0))}),t)}))},S=()=>{const{accountId:e="",siteId:t="",defaultDomain:i=""}=window.DDC.siteSettings,{pageInfo:{pageName:n="",pagePath:a=""},attributes:{locale:o=""}}=window.DDC.dataLayer.page;return{account:e,siteId:t,defaultDomain:i,pageName:n,pagePath:a,locale:o}},$=(i,n)=>{if(100*Math.random()<=5&&window.newrelic){const a=n;"Failed"!==a.status&&(a.status="Success"),window.newrelic.addPageAction("WebIntegrationEvent",{integrationId:e(i.integrationId),integrationType:t(i.integrationType),integrationCategory:i.integrationCategory||"",placesInventoryContent:i.placesInventoryContent||!1,...a,...S()})}},k=e=>{const t=`${e}=`,i=document.cookie.split(";");for(let e=0;e<i.length;e++){let n=i[e];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return n.substring(t.length,n.length)}return null};let x;const j=async()=>{if(!Object.keys(window.DDC.dataLayer).length||!Object.keys(window.DDC.siteSettings).length)throw new Error("DDC DataLayer is not defined. Aborting Web Integration API.");if(!x){var e;const{pageInfo:t,attributes:i}=window.DDC.dataLayer.page,{design:n,franchises:a}=window.DDC.dataLayer.site,{siteSettings:o}=window.DDC,r=null==t?void 0:t.isVlp,s=null==t?void 0:t.isVdp,l=null==t?void 0:t.isHomepage,d=null===(e=document.querySelector('link[rel="canonical"]'))||void 0===e?void 0:e.href,c=(null==t?void 0:t.pageUrl)||"";x={accountId:o.accountId||"",siteId:o.siteId||"",defaultDomain:o.defaultDomain||"",indexPage:l,searchPage:r,detailPage:s,pageName:t.pageName||"",layoutType:i.layoutType||"",locale:i.locale||"",pageUrl:c,childSiteUrl:d!==c?d:"",design:n,franchises:a,ga_clientId:k("_ga")||"",ga_visitorId:k("_gid")||""}}return x};var O,U,M,N;const F=null===(O=window)||void 0===O||null===(O=O.DDC)||void 0===O||null===(O=O.Flags)||void 0===O?void 0:O["wiapi-fetch-priority-js"],R=null===(U=window)||void 0===U||null===(U=U.DDC)||void 0===U||null===(U=U.Flags)||void 0===U?void 0:U["wiapi-fetch-priority-css"],q={fetchPriorityJS:!(!F||"false"===F)&&F,fetchPriorityCSS:!(!R||"false"===R)&&R,inlinePrimaryBanner:(null===(M=window)||void 0===M||null===(M=M.DDC)||void 0===M||null===(M=M.Flags)||void 0===M?void 0:M["wiapi-inline-primary-banner"])||!1,onlyCoxIntegrations:(null===(N=window)||void 0===N||null===(N=N.DDC)||void 0===N||null===(N=N.Flags)||void 0===N?void 0:N["enabled-wise-tps-integration-list"])||""},_=new Set,W=(e,t)=>(t||document).querySelector(e),V=(e,t)=>{const i=t||document;return Array.from(i.querySelectorAll(e))},J=async e=>{if("function"!=typeof e.querySelectorAll)return;const t=await j();var i;if("desktop"===t.layoutType){if(null!==(i=window.DDC)&&void 0!==i&&null!==(i=i.modules)&&void 0!==i&&i.dialog&&!window.DDC.modules.dialog.active&&jQuery(document).trigger("modulesRefresh",{modules:{dialog:window.DDC.modules.dialog}}),window.DDC.modules&&window.DDC.modules.popover){V('[data-toggle="popover"]',e).forEach((e=>{!0!==e.getAttribute("data-initialized")&&window.DDC.modules.popover.load(e)}))}}else if("mobile"===t.layoutType){var n;if("function"==typeof(null===(n=window)||void 0===n||null===(n=n.DDC)||void 0===n||null===(n=n.mobile)||void 0===n||null===(n=n.slidein)||void 0===n?void 0:n.init)){const t=V('.dialog, [data-toggle="popover"]',e);t.length>0&&t.forEach((e=>{window.DDC.mobile.slidein.init(e)}))}}},z=e=>window.DDC&&window.DDC.getUrlParams?(e&&$(e,{methodType:"getUrlParams",status:"Success"}),window.DDC.getUrlParams()):(e&&$(e,{methodType:"getUrlParams",status:"Failed"}),null),H=e=>{var t;const i=(null===(t=window)||void 0===t||null===(t=t.DDC)||void 0===t||null===(t=t.dataLayer)||void 0===t||null===(t=t.page)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t.locale)||"en_US";let n;return"object"==typeof e?n=e[i]?e[i]:e.en_US:"string"==typeof e&&(n=e),n},G=async()=>{var e;const{InvData:t,dataLayer:i,PrivateAPI:n,WS:a}=null===(e=window)||void 0===e?void 0:e.DDC;if(!t)return!1;const{srpReady:o}=t,r=null==a?void 0:a.state["ws-inv-data"];return r&&!0!==(null==n?void 0:n.wsInvListingRendered)&&await T("DDC.PrivateAPI.wsInvListingRendered",100,1e4),t&&(!r||o)&&((e,t)=>{var i;const{pageInfo:n,inventory:a}=(null==e?void 0:e.inventory)||{};return a&&(null==n?void 0:n.totalCount)>=0&&(null==t||null===(i=t.vehicles)||void 0===i?void 0:i.length)===a.length})(t,i)},B=()=>{var e;const{InvData:t,dataLayer:i}=window.DDC;return!t&&(null==i||null===(e=i.vehicles)||void 0===e?void 0:e.length)>=0&&!document.querySelector(".inventory-listing-grid .hproduct")},K=()=>!!W(".inventory-listing-grid .hproduct"),Y=()=>{var e;return null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.dataLayer)||void 0===e||null===(e=e.page)||void 0===e||null===(e=e.pageInfo)||void 0===e?void 0:e.isVdp},Q=()=>{var e;return null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.dataLayer)||void 0===e||null===(e=e.page)||void 0===e||null===(e=e.pageInfo)||void 0===e?void 0:e.isVlp},X=()=>{var e;return Q()&&(null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.WS)||void 0===e?void 0:e.state["ws-inv-listing"])},Z=async e=>!Q()&&!Y()||new Promise((t=>{let i;i=setInterval((async()=>{let n;"inv"===e?n=await G()||B()||K():"facet"===e&&(n=(()=>{var e;return(null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.InvData)||void 0===e||null===(e=e.facets)||void 0===e||null===(e=e.facets)||void 0===e?void 0:e.length)>0})()),n&&(clearInterval(i),t(!0))}),100)})),ee=()=>Z("inv"),te={passive:!0,once:!0,capture:!0},ie=function(e){var t;const i="object"==typeof e?e.integrationId:e;if(null!==(t=window)&&void 0!==t&&null!==(t=t.DDC)&&void 0!==t&&t.integrationLog){for(var n,a=arguments.length,o=new Array(a>1?a-1:0),r=1;r<a;r++)o[r-1]=arguments[r];null===(n=window)||void 0===n||null===(n=n.DDC)||void 0===n||n.integrationLog(i,...o)}},ne=()=>{const e=z();return e&&"debug"===e._integrationMode},ae=()=>{const e=z();return e&&(ne()&&"trace"===e._integrationLogLevel||"trace"===e._integrationMode)};ne();const oe=ae(),re=["[data-location]",".ws-tps-placeholder",".ddc-content"],se=(e,t,i)=>{const o=i.querySelectorAll?i.querySelectorAll("a"):[];[i,...o].forEach((e=>{const t=e.getAttribute?e.getAttribute("href"):e.href;!t||t.startsWith("/")&&!t.startsWith("//")||e.setAttribute("rel","nofollow")}));const r=(e=>{if(!e)return 0;let t,i,n=0;if(0===e.length)return n;const a=e.replace(/key=[0-9a-z%]+/gi,"").replace(/[^0-9a-z]/gi,"");for(t=0;t<a.length;t++)i=a.charCodeAt(t),n=(n<<5)-n+i,n|=0;return n})(i.outerHTML),s=t.closest("[data-location]").querySelectorAll(`[data-web-api-unique-hash="${r}"]`);return s.length>0?(ie(`Already inserted content for ${e.integrationId}. Skipping.`),s):(i.setAttribute("data-web-api-unique-hash",r),i.setAttribute("data-web-api-inserted",!0),i.addEventListener&&i.addEventListener("click",(t=>{((e,t)=>{var i,o;if(!(e||t||null!==(i=window)&&void 0!==i&&null!==(i=i.DDC)&&void 0!==i&&i.fireTrackingEvent))return;const{srcElement:r}=t;let s=r;r.getAttribute("alt")||r.getAttribute("title")?s=r:r.closest("button")?s=r.closest("button"):r.closest("a")&&(s=r.closest("a"));let l=s.closest(`[${a}]`)?s.closest(`[${a}]`).getAttribute(a):"Unknown Location";"page-footer"===l&&(l="overlay-content");const d=s.getAttribute("aria-label")||s.textContent&&["BUTTON","A"].includes(s.tagName)?s.textContent:s.getAttribute("alt")||s.getAttribute("title")||"Third Party Content",c=null===(o=s.closest(".vehicle-card"))||void 0===o?void 0:o.getAttribute("data-uuid"),u={event:"thirdPartyUserEvent",product:e.integrationId,step:n(l.split(" ")[0],"-"),element:d,action:"clicked",result:"success",vehicleUuid:c};window.DDC.fireTrackingEvent(u)})(e,t)}),te),t.appendChild(i),t.classList&&t.classList.remove("hide","hidden"),J(t),re.forEach((e=>{const n=t.closest(e);n&&("primary-banner"===n.getAttribute("data-location")&&i.querySelector("img")&&i.querySelector("img").classList.add("align-center"),n.outerHTML&&n.outerHTML.includes("vehicle-media-container")&&(n.innerHTML="",n.appendChild(t)),n.classList.remove("hide","hidden"))})),$(e,{methodType:"Append",appendElement:i.tagName}),t)};class le{constructor(e){this.name=e,this.getElements=this.getElements.bind(this),this.getMeta=this.getMeta.bind(this),this.isReady=this.isReady.bind(this)}async isReady(){return!0}async getElements(e){const t=`[data-location~="${this.name}"]`,i=null!=e&&e.uuid?document.querySelector(`[data-uuid="${e.uuid}"]`):document;if(!i)return[];const n=i.querySelectorAll(t);return 0===n.length&&oe&&ie("WARNING",`The '${this.name}' location was targeted on this page but does not exist.`),n}async getConfig(){return{elementType:"div"}}prepareLocation(){return!0}getMeta(e){return null}}class de extends le{constructor(e){let{classes:t="",elementType:i="div",singleLocation:n=!1,clearContent:a=!1,placement:o="default"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this.options={classes:t,elementType:i,singleLocation:n,clearContent:a,placement:o}}async getConfig(){return this.options}getMeta(){return j()}}var ce;const ue=["askingPrice","internetPrice","msrp","oemPriceMapHighMSRP","retailValue","salePrice"],he=["accountId","address","autodataCaId","bodyStyle","certified","chromeId","classification","dealerCodes","doors","driveLine","engine","engineSize","exteriorColor","deliveryDateRange","fuelType","images","indexPosition","interiorColor","inventoryDate","inventoryType","make","model","modelCode","odometer","optionCodes","packageCode","priorityType","stockNumber","transmission","trim","uuid","vin"],{additionalInventoryFields:pe=[]}=(null===(ce=window.DDC)||void 0===ce?void 0:ce.dataLayer)||{},ge=(e,t)=>{if(t)return t;let i=e.toLowerCase();return"certified"===i||i.includes("pre")||i.includes("d'occasion")||"usado"===i?i="used":(i.includes("neuf")||"nuevo"===i)&&(i="new"),i},me=(e,t)=>"certified"===e||"true"===t||!0===t||!1,ve=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a=e;return a.highestPrice=a.highestPrice||0,a.startingPrice=a.startingPrice||0,a.finalPrice=a.finalPrice||0,ue.forEach((e=>{const n=e.toLowerCase(),o=t[n]||t[e]||0,r=i(o);a[e]=r,r>a.highestPrice&&(a.highestPrice=r)})),a.startingPrice>a.highestPrice&&(a.highestPrice=a.startingPrice),a.finalPrice>a.highestPrice&&(a.highestPrice=a.finalPrice),0===a.finalPrice&&(a.startingPrice>0?a.finalPrice=a.startingPrice:a.highestPrice>0&&(a.finalPrice=a.highestPrice)),!a.startingPrice&&a.finalPrice&&(a.startingPrice=a.finalPrice),pe.forEach((e=>{void 0!==t[e]&&(a[e]=t[e])})),n.reduce(((e,i)=>({...e,[i]:!1!==t[i]&&(t[i]||"")})),a)},ye=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];window.DDC.PrivateAPI=window.DDC.PrivateAPI||{},window.DDC.PrivateAPI.inventoryData=window.DDC.PrivateAPI.inventoryData||{},0===t.length&&t.push("default");const n=t.join("|").toString();return window.DDC.PrivateAPI.inventoryData[n]&&0!==window.DDC.PrivateAPI.inventoryData[n].length||("responsive"===e?window.DDC.PrivateAPI.inventoryData[n]=await(async e=>{var t,n;const a=(null===(t=window.DDC)||void 0===t||null===(t=t.dataLayer)||void 0===t?void 0:t.vehicles)||[],o=null!==(n=window.DDC)&&void 0!==n&&null!==(n=n.InvData)&&void 0!==n&&n.inventory?window.DDC.InvData.inventory.inventory:[],r=[...he,...e],s={cityFuelEfficiency:"cityFuelEconomy",highwayFuelEfficiency:"highwayFuelEconomy"};return a.map((t=>{var n,a;const l={highestPrice:0,startingPrice:0,year:t.modelYear};r.forEach((e=>{if("certified"===e){const i=t.inventoryType;l[e]=me(i,t[e])}else if(void 0!==t[e]&&!l[e]){const i=t.inventoryType;l[e]="inventoryType"===e?ge(i,t.newOrUsed):t[e]}})),l.status=t.status?t.status.replace(/ /g,"_").toLowerCase():"",Object.entries(s).forEach((e=>{t[e[0]]&&(l[e[1]]=t[e[0]])})),void 0!==t.link&&(l.link=`${window.location.origin}${t.link}`),(void 0===l.optionCodes||1===l.optionCodes.length&&""===l.optionCodes[0])&&(l.optionCodes=[]);const[d]=o.filter((e=>e.uuid===l.uuid&&e)),c=(null==d||null===(n=d.pricing)||void 0===n?void 0:n.dPrice)||(null==d||null===(a=d.pricing)||void 0===a?void 0:a.dprice);let u=!1;return d&&c&&(Object.entries(c).forEach((e=>{if(e.length<2)return;const t=e[1],n=t.typeClass;if(n&&(ue.includes(n)||t.isFinalPrice)){const e="PLEASE_CALL"===t.value?0:i(t.value);e>0&&(e>l.highestPrice&&(l.highestPrice=e),ue.includes(n)&&(l[n]=e),t.isFinalPrice&&l.highestPrice>0&&l.highestPrice/3<e&&(l.finalPrice=e),!1===u&&(l.startingPrice=e,u=!0))}})),!l.finalPrice&&l.startingPrice&&(l.finalPrice=l.startingPrice)),ve(l,t,e)}))})(t):"legacy"===e?window.DDC.PrivateAPI.inventoryData[n]=await(async e=>{var t;const n=await j();if(null===(t=window.DDC)||void 0===t||!t.dataLayer)return[];const a=window.DDC.dataLayer.vehicles||[],o=n.detailPage&&a.length>0?[a[0]]:V("[data-uuid]"),r=[...ue,"oemPriceMapHighMSRP","final-price","stackedFinal"];let s=[];return r.forEach((e=>{s.push(`.${e} .value`),s.push(`.${e} .price`),s.push(`.${e} .price-value`)})),s.push(".final-price .price"),s=s.join(", "),o.map((t=>{const o=[];let l,d,c,u,h=0,p=0,{uuid:g}=t;if(n.detailPage)c=W(".ws-detailed-pricing, .inventory-detail-pricing"),l=`${window.location.origin}${window.location.pathname}`;else if(n.searchPage&&W(".hproduct",t)){c=W(".hproduct",t),g=t.getAttribute("data-uuid");const e=W(".url",c);e&&e.href&&(l=e.href)}if(c&&"string"==typeof c.dealerCodes&&(c.dealerCodes=JSON.parse(c.dealerCodes)),a.length>0){if([u]=a.filter((e=>e.uuid===g&&e)),!u)return ie("INFO",`No data found in data layer for vehicle UUID ${g}. Skipping.`),!1}else c&&(u=c);u.address&&u.accountName&&(u.address.accountName=u.accountName),u.images&&u.images.length>0&&o.push(u.images.map((e=>e.uri))),n.detailPage?d=V(s):n.searchPage&&c&&(d=V(s,c));let m=!1;d.length>0&&d.forEach((e=>{(e.parentElement&&e.parentElement.classList.length>0?Array.from(e.parentElement.classList):[]).forEach((t=>{if(r.includes(t)){const t=i(e.innerText);t&&!m&&(p=t,m=!0),(0===h||h>0&&h/3<t)&&(h=t)}}))}));const v=me(u.inventoryType,u.certified),y=ge(u.inventoryType,u.newOrUsed),w={accountId:u.accountId||"",address:u.address||{},autodataCaId:u.autodataCaId||"",bodyStyle:u.bodyStyle||"",certified:v,chromeId:u.chromeId||"",cityFuelEconomy:parseInt(u.cityFuelEfficiency,10)||0,classification:u.classification||"",dealerCodes:"string"==typeof u.dealerCodes?JSON.parse(u.dealerCodes):u.dealerCodes||{},doors:u.doors||"",driveLine:u.driveLine||"",engine:u.engine||"",engineSize:u.engineSize||"",deliveryDateRange:u.deliveryDateRange||"",exteriorColor:u.exteriorColor||"",finalPrice:h,fuelType:u.fuelType||"",highwayFuelEconomy:parseInt(u.highwayFuelEfficiency,10)||0,images:o,interiorColor:u.interiorColor||"",inventoryDate:u.inventoryDate||"",inventoryType:y,link:l,make:u.make||"",model:u.model||"",modelCode:u.modelCode||"",odometer:parseInt(u.odometer,10)||0,oemSourcedMerchandisingStatus:t.oemSourcedMerchandisingStatus||"",optionCodes:u.optionCodesOther&&u.optionCodesOther.length?u.optionCodesOther:u.optionCodes||[],packageCode:u.packageCode||"",packages:u.packages?u.packages:"",startingPrice:p,status:u.status?u.status.replace(/ /g,"_").toLowerCase():"",stockNumber:u.stockNumber||"",transmission:u.transmission||"",trim:u.trim||"",uuid:u.uuid||"",vin:u.vin||"",year:parseInt(u.modelYear,10)||0};return ve(w,u,e)}))})(t):"grid"===e&&(window.DDC.PrivateAPI.inventoryData[n]=await(async e=>(await j()).searchPage&&0!==V(".inventory-listing-grid").length?V("[data-uuid]").map((t=>{const n=t.dataset,a=[],o=W(".url",t),r=o&&o.href?o.href:"";let s=0,l=0,d=0;const c=V(".image-wrap img",t);if(c.length>0){const e=c[0];e.getAttribute("data-src")?a.push(e.getAttribute("data-src").split("?")[0]):e.src&&a.push(e.src.split("?")[0]),n.images=a}if(!n)return ie("INFO","Vehicle data not found. Aborting inventory events."),!1;if(t.querySelectorAll){const e=V(".detailed-pricing .value, .gv-pricing .value",t);let n=!1;e.forEach((e=>{if(null===e.offsetParent||e.parentElement.classList.contains("stackedConditionalRebate")||e.parentElement.classList.contains("stackedConditionalFinal"))return;const t=i(e.innerText);t&&(t>s&&(s=t),n||(l=t,n=!0),(e.parentElement.classList.contains("stackedFinal")||e.parentElement.classList.contains("finalPrice"))&&(d=t))}))}const u="string"==typeof n.dealercodes?n.dealercodes.replace("{","").replace("}","").split(",").map((e=>e.split("=").map((e=>e.trim())))).reduce(((e,t)=>{let[i,n]=t;return e[i]=n,e}),{}):{},h="string"==typeof n.optioncodes?n.optioncodes.replace(/[[\]\s]/gi,"").split(","):[],p=me(n.type,t.certified),g=ge(n.type,null),m={accountId:n.accountid||"",address:n.address||{},autodataCaId:n.autodatacaid||"",bodyStyle:n.bodystyle||"",certified:p,chromeId:n.chromeid||"",cityFuelEconomy:parseInt(n.cityfueleconomy,10)||0,classification:n.classification||"",dealerCodes:u,doors:n.doors||"",driveLine:n.driveline||"",engine:n.engine||"",engineSize:n.enginesize||"",deliveryDateRange:n.deliveryDateRange||"",exteriorColor:n.exteriorcolor||"",finalPrice:d,fuelType:n.fueltype||"",highwayFuelEconomy:parseInt(n.highwayfueleconomy,10)||0,highestPrice:s,images:a,interiorColor:n.interiorcolor||"",inventoryDate:n.inventorydate||"",inventoryType:g,link:r,make:n.make||"",model:n.model||"",modelCode:n.modelcode||"",odometer:parseInt(n.odometer,10)||0,oemSourcedMerchandisingStatus:n.oemSourcedMerchandisingStatus||"",optionCodes:h,packageCode:n.packagecode||"",packages:n.packages?n.packages:"",startingPrice:l,status:n.status?n.status.replace(/ /g,"_").toLowerCase():"",stockNumber:n.stocknumber||"",transmission:n.transmission||"",trim:n.trim||"",uuid:n.uuid||"",vin:n.vin||"",year:parseInt(n.year,10)||0};return ve(m,n,e)})):(ie("INFO","Not a grid view inventory page. Skipping further inventory processing."),!1))(t))),window.DDC.PrivateAPI.inventoryData[n]},we=async e=>(await ee(),await G()?ye("responsive",e):B()?ye("legacy",e):K()?ye("grid",e):[]),fe=async(e,t)=>{const i=await j();if(!i.searchPage&&!i.detailPage)return[];const n=await we(t);return e&&$(e,{methodType:"getVehicleData",status:"Success"}),n},be=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const n=[],a=he.includes(t)?[]:[t];return(await we(a)).forEach((e=>{e[t]&&(0===i.length||i.includes(e.uuid))&&n.push(e[t])})),e&&$(e,{methodType:"getAttributeForVehicles",status:"Success"}),n};class Pe extends de{async isReady(){return ee()}getMeta(e){return(async(e,t)=>{var i;const n=await j(),a=await we(t),o=(null===(i=window.DDC)||void 0===i||null===(i=i.dataLayer)||void 0===i?void 0:i.vehicles)||[],r=n.detailPage&&o.length>0?o[0].uuid:e.closest("[data-uuid]").getAttribute("data-uuid"),s=a.filter((e=>e.uuid===r&&e));return s.length>0?s[0]:null})(e)}}const Ce="vehicle-card-badge badge hidden";class Ie extends Pe{async getConfig(){return{classes:`${Ce} m-3 p-0`,elementType:"li",gridSrpClasses:`${Ce} align-center m-0 p-3`,responsiveSrpClasses:`${Ce} m-2 py-3`,vdpClasses:`${Ce} align-center`}}}class De extends le{constructor(e){super(e),this.name=e}async isReady(){return ee()}async getConfig(){return{singleLocation:!0}}getMeta(){return j()}}class Ee extends Pe{async getConfig(){return{classes:"badge m-0 mt-3",elementType:"li",gridSrpClasses:"badge m-0",placement:"first",responsiveSrpClasses:"m-0 mb-3 px-3",vdpClasses:"m-0"}}}const Ae="listings-placeholder",Le="listings-ad",Te=Object.freeze({content:new de("content"),"digital-retailing":new Pe("digital-retailing"),"facet-browse":new de("facet-browse"),"header-toolbar":new class extends le{async getConfig(){const e=await j(),t={elementType:"div"},i=document.querySelector(".responsive-centered-nav");return"desktop"===e.layoutType&&(t.classes="d-flex flex-column justify-content-center align-items-end navbar",i&&(t.classes=`${t.classes} m-4`)),t}prepareLocation(){const e=document.querySelector('\n\t\t\t[data-widget-id="template-navbar1"] .navbar-inner\n\t\t');if(!e)return;const t=e.querySelectorAll("\n\t\t\t.ddc-btn-nav,\n\t\t\tdiv.ddc-btn-wiapi\n\t\t");e.className=e.className.replace(new RegExp(/navbar-inner-count-\d/,"g"),""),e.classList.add(`navbar-inner-count-${t.length.toString()}`)}getMeta(){return j()}}("header-toolbar"),heading:new de("heading"),"listing-filters":new De("listing-filters"),"listings-placeholder-1":new De(`${Ae}-1`),"listings-placeholder-2":new De(`${Ae}-2`),"listings-placeholder-3":new De(`${Ae}-3`),"listings-placeholder-4":new De(`${Ae}-4`),"listings-placeholder-5":new De(`${Ae}-5`),"listings-ad-1":new De(`${Le}-1`),"listings-ad-2":new De(`${Le}-2`),"listings-ad-3":new De(`${Le}-3`),"mobile-vdp-footer":new Pe("mobile-vdp-footer",{elementType:"li",clearContent:!0}),"primary-menu-top":new de("primary-menu-top",{classes:"panel panel-default",elementType:"li",singleLocation:!0,placement:"first"}),"primary-menu-bottom":new de("primary-menu-bottom",{classes:"panel panel-default",elementType:"li",singleLocation:!0}),"page-footer":new de("page-footer"),"primary-banner":new class extends le{constructor(e){super(e),this.name=e}isReady(){return ee()}getMeta(){return j()}}("primary-banner",{classes:"mt-3 px-4"}),"privacy-form":new de("privacy-form",{clearContent:!0,singleLocation:!0}),"search-facet-pricing":new class extends le{constructor(e){super(e||"search-facet")}async isReady(){return Z("facet")}async getConfig(){return{classes:"facet m-0 mt-3",elementType:"div",responsiveSrpClasses:"m-0 mb-3 px-3",singleLocation:!0}}getMeta(){return j()}}("search-facet-pricing"),"secondary-content":new de("secondary-content"),"site-text-search":new de("site-text-search"),"vehicle-badge":new Ie("vehicle-badge"),"vehicle-badge-custom":new Ie("vehicle-badge-custom"),"vehicle-build-offer":new Pe("vehicle-build-offer",{classes:"mb-3"}),"vehicle-ctas":new Pe("vehicle-ctas",{classes:"mb-3"}),"vehicle-ctas-bottom":new Pe("vehicle-ctas-bottom",{classes:"mb-3"}),"vehicle-ctas-custom":new Pe("vehicle-ctas-custom",{classes:"mb-3"}),"vehicle-ctas-top":new Pe("vehicle-ctas-top",{classes:"mb-3"}),"vehicle-media":new Ee("vehicle-media"),"vehicle-media-container":new Pe("vehicle-media-container"),"vehicle-media-custom":new Ee("vehicle-media-custom"),"vehicle-payments":new Pe("vehicle-payments",{classes:"mb-3",singleLocation:!0}),"vehicle-payments-primary":new Pe("vehicle-payments-primary",{classes:"mb-3",singleLocation:!0}),"vehicle-payments-custom":new Pe("vehicle-payments-custom",{classes:"mb-3",singleLocation:!0}),"vehicle-pricing":new Pe("vehicle-pricing",{classes:"mb-3"}),"vehicle-pricing-custom":new Pe("vehicle-pricing-custom",{classes:"mb-3"}),"vehicle-pricing-digital-retailing":new Pe("vehicle-pricing-digital-retailing",{classes:"mb-3"})}),Se=["ask","drive"],$e=[],ke=["x-time","schedule-service","quote-build","value-a-trade","payment-search","pre-approval"],xe={},je={};["chat","check-availability","delivery","digital-retailing","eprice","location-finder","payment-calculator","pre-approval","request-a-quote","reserve-it-now","send-to-phone","social","test-drive","text-us","value-a-trade","window-sticker"].forEach((e=>{const t=`vehicle-${e}-button`;xe[t]=new Pe(t)})),Se.forEach((e=>{const t=`vehicle-${e}-button`;$e.push(t),je[t]=new Pe(t)}));const Oe=Object.freeze({...xe,...je}),Ue=Object.keys(Te),Me=Object.keys(xe),Ne=Object.keys(je),Fe=X(),Re=(e,t)=>("object"==typeof t&&Object.keys(t).forEach((i=>{i&&e.setAttribute(i,t[i])})),e),qe=(e,t,i)=>(t.classList.remove("hidden"),e.init&&e.init.integrationId&&t.setAttribute("data-modified-by",e.init.integrationId),t.setAttribute("data-content-source","Web Integration API"),e.targetLocation&&t.setAttribute("data-content-intent",e.targetLocation),e.destinationLocation&&t.setAttribute("data-content-destination",e.destinationLocation),i&&t.setAttribute("data-location",i),t),_e=function(e,t,i){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=!e.destinationLocation||!$e.includes(e.destinationLocation);let r;t.closest(".ddc-mobile-header-nav")||t.closest('[data-location~="primary-menu"]')||t.closest(".mobile-menu")||t.closest(".ddc-mobile-header-sub-nav")||t.closest("#ddc-mobile-header-nav")||i.onclick?r=t:(r=t.parentNode?t.cloneNode(!0):t,t.parentNode&&t.parentNode.replaceChild(r,t));const s=H(i.text);if(i.href?r.href=i.href:i.src?r.href=i.src:(r.setAttribute("href","#"),r.removeAttribute("data-href")),i.style&&"string"==typeof i.style&&(r.style=i.style.trim()),n&&o&&(r.classList.add("btn","btn-block"),Fe&&r.classList.add("btn-sm"),r.classList.remove("btn-default","btn-primary")),i.imgSrc){r.innerHTML="";let e=document.createElement("img");e.src=i.imgSrc,e.alt=i.imgAlt?H(i.imgAlt):s,i.imgClasses&&(e.className=i.imgClasses),e=Re(e,i.imgAttributes),r.appendChild(e)}else s&&(r.innerHTML=s,r.setAttribute("alt",s),n&&o&&("primary"===i.type||"text"===i.type?r.classList.add(`btn-${i.type}`):r.classList.add("btn-default")));if(i.onclick){if(r.dataset.wiapiProcessed)return r;const e=function(e){e.preventDefault();try{return i.onclick.call(this,e)}catch(e){throw ie("[BUTTONMARKUP] Error in onclick handler:",e),e}};r.addEventListener("click",e),r.dataset.wiapiProcessed="true"}if(i.target&&r.setAttribute("target",i.target),["data-width","data-dialog-class"].forEach((e=>{r.removeAttribute(e)})),r=Re(r,i.attributes),["dialog","hide","hidden"].forEach((e=>{r.classList.remove(e)})),i.classes&&""!==i.classes.trim()&&i.classes.trim().split(" ").forEach((e=>{r.classList.add(e)})),a&&(r=qe(e,r)),i.popover){const e={toggle:"popover",animation:i.popover.animation||!0,container:i.popover.container||"body","delay-show":i.popover.delayShow||0,"delay-hide":i.popover.delayHide||0,title:H(i.popover.title)||"",content:H(i.popover.content)||"",html:i.popover.html||"",placement:i.popover.placement||"left",trigger:i.popover.trigger||"hover"};Object.keys(e).forEach((t=>{r.setAttribute(`data-${t}`,e[t])}))}return r};class We{constructor(){this.data={},this.push=this.push.bind(this),this.forEach=this.forEach.bind(this),this.ensureListForKey=this.ensureListForKey.bind(this),this.clear=this.clear.bind(this)}push(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.ensureListForKey(e).push(...i)}forEach(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.ensureListForKey(e).forEach(...i)}ensureListForKey(e){return void 0===this.data[e]&&(this.data[e]=[]),this.data[e]}clear(){this.data={}}}const Ve=Object.freeze({"schedule-service":new class extends le{constructor(){super("page-schedule-service-button")}}}),Je=Object.keys(Ve),ze=(e,t)=>{if("string"!=typeof e||0===e.length)throw new Error(`${t} must be a non-zero length string. Got: ${e}.`)},He=(e,t)=>{if(!e||"object"!=typeof e)throw new Error(`${t} must be an object. Got: ${e}.`)},Ge=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;const n=Object.keys(e),a=[];if(!n.every((e=>{const i=t.indexOf(e)>=0;return i||a.push(e),i})))throw new Error(`Found the following invalid props '${a.join(", ")}'. Only the following props are allowed '${t.join(", ")}', in ${i}.`)},Be=(e,t)=>{He(e,t),ze(e.integrationId,"integrationId"),ze(e.integrationType,"integrationType")};class Ke{constructor(e,t){Be(e,"init"),this.init=e,this.callback=t}}const Ye=new We,Qe=new We,Xe=(e,t,i)=>{try{t((n=i,JSON.parse(JSON.stringify(n))))}catch(t){ie(`Callback failed: ${e} ${JSON.stringify(i)}.`,t)}var n},Ze=["vehicle-media"],et=["image","html"],tt=["primary","secondary","last"],it=["insert","replace"],nt={"vehicle-media":{}},at=new Set,ot=e=>{if(!Ze.includes(e))throw new Error(`Unsupported gallery: '${e}'. Expected one of: ${Ze.join(", ")}.`)},rt=(e,t)=>{if(!t)throw new Error(`Unsupported request. ${e} is a required field.`)},st=window._.debounce((e=>{const t={vin:e,content:nt["vehicle-media"][e]};window.dispatchEvent(new CustomEvent("wiapiVehicleMediaUpdated",{detail:t}))}),100),lt=window._.debounce((()=>{window.dispatchEvent(new CustomEvent("wiapiAllVehiclesMediaUpdated",{detail:{content:nt["vehicle-media"]}}))}),100),dt=(e,t,i)=>{t.forEach((t=>{const{vin:n,images:a,insertMethod:o="insert"}=t;rt("vin",n),rt("images",a),(e=>{if(!it.includes(e))throw new Error(`Unsupported vehicle media content insertMethod: '${e}'. Expected one of: ${it.join(", ")}.`)})(o);const r=i.find((e=>e.vin===n));nt["vehicle-media"][n]=nt["vehicle-media"][n]||tt.reduce(((e,t)=>(e[t]=[],e)),{}),nt["vehicle-media"][n].insertMethod=o,nt["vehicle-media"][n].vehicle=r,a.forEach((t=>{const{type:i,position:a,src:o,thumbnail:r="",html:s,trigger:l="click",callback:d}=t;if((e=>{if(!et.includes(e))throw new Error(`Unsupported vehicle media content type: '${e}'. Expected one of: ${et.join(", ")}.`)})(i),(e=>{if(!tt.includes(e))throw new Error(`Unsupported vehicle media position: '${e}'. Expected one of: ${tt.join(", ")}.`)})(a),et.includes(i)){const t=`${n}${a}${o}`;let c="";if(!o||""===o.trim())throw c="Vehicle media images must have a 'src' property.",e&&$(e,{methodType:"insertVehicleMedia",status:"Failed",message:c}),new Error(c);if("html"===i&&(!s&&!d||s&&""===s.trim()&&!d))throw c="Vehicle media HTML must have an 'html' property with content.",e&&$(e,{methodType:"insertVehicleMedia",status:"Failed",message:c}),new Error(c);at.has(t)||nt["vehicle-media"][n][a].push({vin:n,type:i,src:o,thumbnail:r&&""!==r.trim()?r:o,position:a,html:s,trigger:l,callback:d}),at.add(t)}})),st(n)})),lt()},ct=e=>{const t=document.createElement("template"),i=e.trim();return t.innerHTML=i,t.content.firstChild},ut=e=>e.includes("{")&&e.includes("}"),ht=(e,t)=>{let i=e;return Object.keys(t).forEach((e=>{if("integrationUrl"!==e&&i.includes(`{${e}}`)){const n=new RegExp(`{${e}}`,"g");i=i.replace(n,t[e])}})),i},pt=async()=>{var e;if(null!==(e=window.DDC)&&void 0!==e&&null!==(e=e.apiLoaderInstance)&&void 0!==e&&e.loadConfigs)return window.DDC.apiLoaderInstance.loadConfigs();if(window.DDC.PrivateAPI=window.DDC.PrivateAPI||{},window.DDC.PrivateAPI.integrationConfigs){const e=window.DDC.PrivateAPI.integrationConfigs;if("function"==typeof e.then)return ie("loadConfigs","Using existing config promise"),e;if("object"==typeof e&&null!==e)return ie("loadConfigs","Using cached config data"),Promise.resolve(e)}throw new Error("APILoader not available for config loading. Ensure loader.js is included before the main API.")},gt=async t=>{const{settings:i}=window.DDC.Integration;return Object.keys(i).forEach((t=>{e(t)!==t&&(i[e(t)]=i[t],delete i[t])})),void 0!==i[t.integrationId]&&($(t,{methodType:"getConfigDeprecated",status:"Success"}),i[t.integrationId])},mt=async function(e,t,i,n){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o="object"==typeof i&&(ne()||ae()),r=z();if(t[e.integrationId]){if(o&&"override"===r._integrationConfig)return i;const n=t[e.integrationId].fields,s=await j(),{layoutType:l}=s;if(!t[e.integrationId].wiseIntegration){const t="mobile"===l&&!0===n.enabledSeamless,i="desktop"===l&&!0===n.enabledDesktop;if(!t&&!i)throw a&&$(e,{methodType:"getConfig",status:`Disabled for ${l}`}),new Error(`Config for ${e.integrationId} found but not enabled for the current device type.`)}const d=["includedPages","excludedPages","thirdPartyServiceDebug"],c={srp:"searchPage",vdp:"detailPage",index:"indexPage"},u=Object.keys(n).filter((e=>!d.includes(e)&&!e.startsWith("enabled")&&!e.startsWith("addTo"))).reduce(((t,i)=>{const a=t;if(i.split("-").length>1){const[t,o]=i.split("-");s[c[o]]&&(ae()&&ie(e.integrationId,`Using override key '${i}' to set field '${t}' to '${n[i]}' for '${c[o]}'.`),a[t]=n[i])}else i in a||(a[i]=n[i]);return a}),{});return a&&$(e,{methodType:"getConfig",status:"Success"}),u}{if(o)return i;a&&$(e,{methodType:"getConfig",status:"Not Found"});const r=n?[...Object.keys(t),...Object.keys(window.DDC.Integration.settings)]:Object.keys(t),s=r.length?`Integration configs are available only for the following -> ${[...new Set(r)].join(", ")}`:"";throw new Error(`Config for ${e.integrationId} not found. ${s}`)}},vt=async(e,t,i)=>{const n=await pt();$(e,{methodType:t,status:"Success"});const a=(o=[e.integrationId,...i],r=n,o.reduce(((e,t)=>e&&e[t]?e[t]:null),r));var o,r;return null===a?{}:a},yt=async e=>vt(e,"getContentMappings",["contentMappings"]),wt=async e=>vt(e,"getSiteProperties",["supplementaryData","siteProperties"]),ft=async e=>vt(e,"getSitemap",["supplementaryData","siteMaps"]),bt=async function(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=null===(t=window)||void 0===t||null===(t=t.DDC)||void 0===t||null===(t=t.Integration)||void 0===t?void 0:t.settings;if(a){const t=await gt(e);if(!1!==t)return t}try{const t=await pt(),o=await mt(e,t,i,a,n);if(o)return o}catch(t){n&&$(e,{methodType:"getConfig",status:"Failed",message:t}),ie(e,`Error calling getConfig. ${t}`)}return null};var Pt=Object.freeze({__proto__:null,hasPlaceHolders:ut,replacePlaceHolders:ht,loadConfigs:pt,processLegacyConfigData:gt,processConfigData:mt,getContentMappings:yt,getSiteProperties:wt,getSitemap:ft,getConfig:bt});const Ct=(e,t,i)=>{void 0===window.DDC.PrivateAPI&&(window.DDC.PrivateAPI={}),void 0===window.DDC.PrivateAPI.timings&&(window.DDC.PrivateAPI.timings={}),void 0===window.DDC.PrivateAPI.timings[e]&&(window.DDC.PrivateAPI.timings[e]={}),void 0===window.DDC.PrivateAPI.timings[e][t]&&(window.DDC.PrivateAPI.timings[e][t]=[]),window.DDC.PrivateAPI.timings[e][t].push(i)};class It extends le{constructor(e){super(),this.searchSelectors=e}getMeta(){return j()}async getElements(){const e=[],t=new Set;this.searchSelectors.forEach((i=>{const n=Array.from(document.querySelectorAll(i)),a=n.filter((e=>!e.dataset.wiapiProcessed)),o=n.filter((e=>e.dataset.wiapiProcessed));o.length>0&&o.forEach((e=>{e.removeAttribute("data-wiapiprocessed"),a.push(e)})),a.forEach((i=>{t.has(i)||(e.push(i),t.add(i))}))}));return[".ddc-mobile-fragment-nav",'[data-location~="primary-menu"]',".mobile-menu","#ddc-mobile-header-nav"].forEach((i=>{const n=document.querySelector(i);n&&this.searchSelectors.forEach((i=>{const a=Array.from(n.querySelectorAll(i)),o=a.filter((e=>!e.dataset.wiapiProcessed)),r=a.filter((e=>e.dataset.wiapiProcessed));r.length>0&&r.forEach((e=>{e.removeAttribute("data-wiapiprocessed"),o.push(e)})),o.forEach((i=>{t.has(i)||(e.push(i),t.add(i))}))}))})),e}}const Dt=[h,p,g,m,v];class Et{constructor(e,t,i,n,a,o,r){const d=o||n;Be(e,"init"),((e,t)=>{let i=Ue;if(e===u&&(i=Me),e===s&&(i=[...Me,...Ue]),e===c&&(i=Ne),e===l&&(i=ke),!i.includes(t))throw new Error(`Invalid location: ${t}. Valid options are: ${i.join(", ")}.`)})(i,d),this.uniqueId=(()=>{const e=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e()+e()+e()+e()})(),this.init=e,this.methodType=i,this.targetLocation=d,this.destinationLocation=null,this.defaultLocation=n,this.type=a,this.integrationCall=r,this.getInsertSite=this.getInsertSite.bind(this),this.apply=this.apply.bind(this),this.timingKey=`${this.init.integrationId}-${this.targetLocation}`}async getInsertSite(e,t){if(null!=t&&t.singleLocation){const i=[`[data-web-api-id="${this.init.integrationId}"]`];null!=t&&t.placement&&i.push(`[data-web-api-placement="${t.placement}"]`);const n=null==e?void 0:e.querySelector(i.join(""));if(n)return n}const i=null!=t&&t.elementType?t.elementType:"div",n=document.createElement(i);n.setAttribute("data-web-api-id",this.init.integrationId),null!=t&&t.placement&&n.setAttribute("data-web-api-placement",t.placement),n.setAttribute("data-web-api-unique-id",this.uniqueId);let a="",o="";if(t&&(t.style&&n.setAttribute("style",t.style),t.responsiveSrpClasses&&await G()?o=`${t.responsiveSrpClasses}`:t.gridSrpClasses&&K()?o=`${t.gridSrpClasses}`:t.vdpClasses&&Y()?(a=`${a} p-4`,null!=e&&e.getAttribute("data-list-classes")&&(a=null==e?void 0:e.getAttribute("data-list-classes")),o=`${t.vdpClasses}`):t.classes&&(o=`${t.classes}`),n.setAttribute("class",`${o} ${a} hidden`)),null!=t&&t.clearContent)for(;null!=e&&e.firstChild;)e.removeChild(e.firstChild);return null!=t&&t.placement&&"first"===(null==t?void 0:t.placement)&&null!=e&&e.firstChild?e.insertBefore(n,e.firstChild):null==e||e.appendChild(n),n}async apply(e,t){const i=Date.now(),n=await bt(this.init,!1,!1);null!=n&&n.useCustomInsertLocations&&Dt.includes(this.targetLocation)&&!this.targetLocation.endsWith("-custom")&&(this.targetLocation=`${this.targetLocation}-custom`);let a=null;if(this.methodType===s||this.methodType===c){const e=await yt(this.init),t=e.buttons||e.button;t&&Object.entries(t).forEach((e=>{const[t,i]=e;t===this.targetLocation&&i&&(a=Oe[i]?Oe[i]:new Pe(i),this.destinationLocation=i)})),await ee(),a&&("hidden"===a.name||document.querySelector(`[data-location="${a.name}"]`))||(a=Te[this.defaultLocation],this.methodType=r)}else if(this.methodType===r)a=Te[this.defaultLocation];else if(this.methodType===o)a=Te[this.targetLocation];else if(this.methodType===u)a=Oe[this.targetLocation];else if(this.methodType===l){const e=((await yt(this.init)).links||{})[this.targetLocation]||[];if(e&&e.length){const t=e.map((e=>`a[href^="${e}"]`));t.some((e=>document.querySelectorAll(e).length>0))?a=new It(t):ie("[EDITOR] No links found for any selectors")}else ie("[EDITOR] No link targets found for intent:",this.targetLocation)}if(!a)return;await a.isReady();const d=await a.getElements(e),h=await a.getConfig();setTimeout((()=>{d&&d.forEach((async d=>{try{var p,g;const m=await a.getMeta(d),y=!(!t||!e||(null==e?void 0:e.uuid)!==(null==m?void 0:m.uuid))||!e,w=0===(null==d||null===(p=d.querySelectorAll(`[data-web-api-unique-id="${this.uniqueId}"]`))||void 0===p?void 0:p.length);if(!y||!w)return;if(await a.prepareLocation(d),this.methodType===r||this.methodType===s||this.methodType===c||this.methodType===l){const e=this.integrationCall(m);if("object"!=typeof e)return;{let t=e;if(this.methodType===c||this.methodType===l){const{href:i,target:n,onclick:o,popover:r,attributes:s,...c}=e;t={href:i,target:n,onclick:o,popover:r,attributes:s};const u=Object.keys(c||{});if(u.length){const e=u.join(", ");ie(this.init.integrationId,`tried to modify the following button attributes ${e} of ${a.name} which is not allowed.`)}const h=_e(this,d,t,this.methodType!==l);J(h)}else if(this.methodType===r){const e=document.createElement("a");se(this.init,await this.getInsertSite(d,h),_e(this,e,t)),J(e)}else if(this.methodType===s){let e;const i="A"===d.nodeName;i&&(e=await this.getInsertSite(null,h),d.parentNode.appendChild(e),e=qe(this,e,d.getAttribute("data-location")),d.getAttribute("data-location")&&d.removeAttribute("data-location"));const n="BUTTON"===d.nodeName;let a,o;n&&(a=document.createElement("a"),d.replaceWith(a)),o=i?d:n?a:d.querySelector("a");const r=_e(this,o,t,!0,!i);e&&e.appendChild(r),J(r)}}}else if(this.methodType===o){(null==n?void 0:n.renderAsFirstChild)&&a.name===v&&(h.placement="first"),this.integrationCall(await this.getInsertSite(d,h),m)}else this.methodType===u&&(ie("WARNING: The `API.update` method is deprecated and will soon be removed. Please use `API.insertCallToAction` instead. For details, please visit https://dealerdotcom.github.io/web-integration-api-docs/#api-insertcalltoaction-type-intent-setupfunction-meta"),this.integrationCall(d,m));const f=d.closest("[data-location]");null==f||null===(g=f.classList)||void 0===g||g.remove("hide","hidden"),$(this.init,{methodType:this.methodType,status:"Success",locationName:this.targetLocation});const b=Date.now();Ct(this.methodType,this.timingKey,b-i)}catch(e){const t=Date.now();ie(this.init.integrationId,`Failed to edit into ${this.targetLocation} and took ${t-i}ms to fail... ${e}`),$(this.init,{methodType:this.methodType,status:"Failed",locationName:this.targetLocation,message:e})}}))}),0)}}const At=new Set,Lt="listings-placeholder";let Tt=null,St=null;const $t=(e,t,i)=>{e.size>=5&&(t&&t.disconnect(),Tt=e,i(e))},kt=()=>{if(St)return St;const e=`[data-location*="${Lt}"]`,t=document.querySelectorAll(e),i=new Map;return t.forEach((e=>{const t=e.getAttribute("data-location"),n=i.get(t)||[];i.set(t,[...n,e])})),St=new Promise((t=>{$t(i,null,t);const n=new MutationObserver((a=>{a.forEach((a=>{if("childList"===a.type){a.target.querySelectorAll(e).forEach((e=>{const t=e.getAttribute("data-location"),n=i.get(t)||[];i.set(t,[...n,e])})),$t(i,n,t)}}))})),a=document.querySelector(".srp-wrapper-listing");a&&n.observe(a,{childList:!0,subtree:!0})})),St},xt=e=>!(null==e||!e.includes(Lt)),jt=e=>At.has(e),Ot=e=>C.includes(e),Ut=async(e,t)=>{var i;if(t===`${Lt}-5`)return!0;if(t===`${Lt}-1`)return!!Ot(e.integrationId)||(window.DDC.PrivateAPI.hasPrimaryPlaceholderIntegration||Tt||(Tt=await kt()),!(window.DDC.PrivateAPI.hasPrimaryPlaceholderIntegration||jt(t)));Tt||(Tt=await kt());return 0!==((null===(i=Tt)||void 0===i?void 0:i.get(t))||[]).length&&!jt(t)},Mt=async(e,t)=>{let i=t;if(i===d&&X()&&q.inlinePrimaryBanner&&(i=`${Lt}-1`),!xt(i))return i;const n=await(async(e,t)=>{if(await Ut(e,t))return t;Tt||(Tt=await kt());const i=Array.from(Tt.keys());i.sort();const n=i.find((i=>!jt(i)&&i!==t&&Ut(e,i)));return n||`${Lt}-5`})(e,i);return(e=>{xt(e)&&At.add(e)})(n),n},Nt=new Set,Ft=new Set,Rt=new Set,qt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Nt.forEach((t=>{const{exclude:i,include:n}=e;t.targetLocation?i&&t.targetLocation.startsWith(i)||n&&!t.targetLocation.startsWith(n)||t.apply():ie("No target location was set for insert:",t)}))},_t=function(e,t,i,n,a,r,l){let d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];const h=new Et(i,e,t,n,a,r,l),p=window.DDC.InvData&&n&&n.startsWith("vehicle");d?(t===o||[u,s,c].includes(t))&&(n&&n.startsWith("vehicle")?Ft.add(h):Nt.add(h)):!d&&p&&Rt.add(h),h.apply();return $(i,{methodType:t,locationName:r||n}),h},Wt=async function(e,t,i){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("object"!=typeof e||null===e)throw new Error(`init must be an object. Got: ${e}.`);const a=await Mt(e,t);return _t("insert",o,e,a,null,null,i,n)},Vt=async function(e,t,i,n){let a,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=null;const l=await bt(e);"button"===t&&(r=null!=l&&l.useCustomInsertLocations?"vehicle-ctas-custom":"vehicle-ctas",a=`vehicle-${i}-button`);const d=Se.includes(i)?c:s;return _t("insertCallToAction",d,e,r,t,a,n,o)},Jt=async function(e,t,i){return _t("update",u,e,t,null,null,i,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])},zt=["mobile"],Ht=["top","bottom"],Gt=["primary-menu"],Bt={},Kt=(e,t,i)=>{(e=>{if(!e)throw new Error("Location is required to set a modification.");if(Bt[e])throw new Error(`The location '${e}' has already been modified by integration '${Bt[e].integration}'.`)})(t),Bt[t]={integration:e,...i},(e=>window._.debounce((()=>{window.dispatchEvent(new CustomEvent("wiapiPageModificationUpdate",{detail:{location:e}}))}),100))(t)()},Yt="wiapiSettings",Qt=["showPayments","useFilterSortPlaceholders","delayLoadVdpFooter"],Xt=e=>{const t=JSON.parse(sessionStorage.getItem(Yt))||{};return e?(null==t?void 0:t[e])||{}:t},Zt=async e=>(await L(),Xt(e)),ei=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=await j(),{pageName:a}=n;if(!a)return;const o=Xt(),r=(e=>["true","false"].includes(e)?"true"===e:e)(t);o[a]||(o[a]={}),void 0===r||!i&&!0===o[a][e]||(o[a][e]=r,(e=>{sessionStorage.setItem(Yt,JSON.stringify(e))})(o))},ti=e=>(Qt.forEach((async t=>{void 0!==e[t]&&ei(t,e[t])})),!0);class ii{constructor(i,n,a,o,r){const s="string"==typeof i?i:i.integrationId,l="string"==typeof i?i:i.integrationType;ze(s,"integrationId"),ze(n,"src"),ze(a,"type"),((e,t)=>{if(!(e instanceof Map))throw new Error(`${t} must be a Map. Got: ${typeof e}.`)})(o,"attributes"),this.init={integrationId:e(s),integrationType:t(l)},this.src=n,this.fileType=a,this.attr=o,this.immutableAttr=["data-web-api-id","data-web-api-type","async","type","src"],this.methodType=this.fileType?`load${this.fileType.toUpperCase()}`:"Load",this.isIntegrationLoad=r,this.load=this.load.bind(this),this.invoked=!1}load(e){if(this.invoked)return new Promise((e=>{e(`Resource ${this.src} already loaded.`)}));const t=e=>{const t=this.isIntegrationLoad?"Integration Loaded":this.methodType;$(this.init,{methodType:t,load:this.src,status:e})},i=()=>(this.invoked=!0,new Promise(((e,i)=>{const n="js"===this.fileType?"script":"link",a=document.createElement(n);switch(a.setAttribute("data-web-api-id",this.init.integrationId),a.setAttribute("data-web-api-type",this.init.integrationType),n){case"script":if(a.type="text/javascript",a.src=this.src,a.async=!0,q.fetchPriorityJS&&a.setAttribute("fetchpriority",q.fetchPriorityJS),this.attr.forEach(((e,t)=>{switch(t){case"priority":break;case"jstype":case"type":"module"===e&&a.setAttribute("type","module");break;case"synchronicity":"async"===e&&a.setAttribute("async","async");break;default:this.immutableAttr.includes(t)||a.setAttribute(t,e)}})),["body","head"].includes(this.attr.get("priority")))return;document.body.appendChild(a);break;case"link":a.type="text/css",a.rel="stylesheet",a.media="all",a.href=this.src,q.fetchPriorityCSS&&a.setAttribute("fetchpriority",q.fetchPriorityCSS),document.head.appendChild(a)}a.onload=()=>{this.invoked=!0,t("Success"),e(this.src)},a.onerror=()=>{t("Failed"),i(this.src)}})).catch((e=>{ie(this.init.integrationId,`ERROR: ${e.toString()} failed to load!`)})));return["all","css"].includes(e)&&"css"===this.fileType||["all","js"].includes(e)&&"js"===this.fileType?i():"unknown"===this.fileType&&new Promise(((e,t)=>{t(new Error(`Failed to load unknown resource type of file ${this.src}`))}))}}const ni=[],ai=z(),oi=async function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,a=arguments.length>4?arguments[4]:void 0;const o=i||(e=>e.includes(".css")||e.includes("/css")?"css":e.includes(".js")||e.includes("/js")?"js":"unknown")(t),r=new ii(e,t,o,n,a);return!!ni.some((e=>e.src===t))||(ni.push(r),r.load(o))},ri=async function(e,t,i){return oi(e,t,"js",i,arguments.length>3&&void 0!==arguments[3]&&arguments[3])},si=e=>ni.forEach((t=>{t.invoked||t.load(e)})),li=k("WebIntegrationAPITestLoader");if(li&&void 0!==ai._integrationMode){const e=li.split("|"),t=e[0],i=e[1];oi(t,i)}const di="DISABLE_THIRD_PARTY",ci="ENABLE_THIRD_PARTY",ui="DEBUG_THIRD_PARTY",hi="COX_ONLY",pi="RESET_CUSTOM",gi="INVALID_PROTOCOL",mi="DEVICE_ENABLEMENT",vi=e=>{switch(e){case hi:return(()=>{throw new Error("External integrations are disabled due to onlyCoxIntegration mode.")})();case ui:return(()=>{throw new Error("This integration is disabled because Third Party Debug is enabled.")})();case mi:return(()=>{throw new Error("Integration disabled for target device.")})();case di:return(()=>{throw new Error("Integration disabled due to _onlyDisableThirdParty param.")})();case ci:return(()=>{throw new Error("Integration disabled due to _onlyEnableThirdParty param.")})();case gi:return(()=>{throw new Error("URL defined does not start with https:// or / and HTTPS is required.")})();case pi:return(()=>{throw new Error("Integrations are disabled.")})();default:return(()=>{throw new Error("An Error occured validating an Integration")})()}},yi=(e,t)=>{switch(e){case hi:return(e=>{const{integrationId:t,integrationUrl:i}=e;ie(t,"External integrations are disabled due to onlyCoxIntegration mode.",`Skipping JS: ${i}`)})(t);case ui:return(e=>{const{integrationId:t,integrationUrl:i}=e;ie(t,"This integration is disabled because Third Party Debug is enabled.",`Skipping JS: ${i}`)})(t);case mi:return(e=>{const{integrationId:t}=e;ie(t,`Config for ${t} found but not enabled for the current device type.`)})(t);case di:return(e=>{const{integrationId:t}=e;ie(`Skipping load of ${t} due to _onlyDisableThirdParty URL parameter.`)})(t);case ci:return(e=>{const{integrationId:t}=e;ie(`Skipping load of ${t} due to _onlyEnableThirdParty URL parameter.`)})(t);case gi:return(e=>{const{integrationId:t}=e;ie(`ERROR with '${t}' integration setup:`,"URL defined does not start with https:// or / and HTTPS is required.")})(t);case pi:return(e=>{const{integrationId:t,integrationUrl:i}=e;ie(t,`Integrations are disabled. Skipping JS: ${i}`)})(t);case"LOADING_INTEGRATION_JS":return(e=>{const{integrationId:t,integrationUrl:i}=e;ie(t,`Loading Integration JS: ${i}`)})(t);default:return}};class wi{constructor(e,t,i,n,a,o,r,s,l){this.debugMode=e,this.enabledDesktop=t,this.enabledSeamless=i,this.integrationId=n,this.integrationUrl=a,this.integrationList=o,this.layoutType=r,this.urlParams=s,this.wiseIntegration=l}reducer(e){switch(e){case hi:((e,t)=>{const{integrationId:i,urlParams:n,integrationList:a,integrationUrl:o}=t,r=((e,t,i)=>!("onlyCoxIntegration"===t._mode&&!i.includes(e)))(i,n,a);r||(yi(e,{integrationId:i,integrationUrl:o}),vi(e))})(e,{integrationId:this.integrationId,urlParams:this.urlParams,integrationList:this.integrationList,integrationUrl:this.integrationUrl});break;case ui:((e,t)=>{const{debugMode:i,integrationId:n,integrationUrl:a,urlParams:o}=t,r=((e,t)=>!0!==t||"true"===e.thirdPartyServiceDebug)(o,i);r||(yi(e,{integrationId:n,integrationUrl:a}),vi(e))})(e,{debugMode:this.debugMode,integrationId:this.integrationId,integrationUrl:this.integrationUrl,urlParams:this.urlParams});break;case mi:((e,t)=>{const{wiseIntegration:i,layoutType:n,enabledSeamless:a,enabledDesktop:o,integrationId:r}=t;((e,t,i,n)=>{if(!e)switch(t){case"mobile":return i;case"desktop":return n;default:return!1}return!0})(i,n,a,o)||(yi(e,{integrationId:r}),vi(e))})(e,{wiseIntegration:this.wiseIntegration,layoutType:this.layoutType,enabledSeamless:this.enabledSeamless,enabledDesktop:this.enabledDesktop,integrationId:this.integrationId});break;case di:((e,t)=>{const{integrationId:i,urlParams:n}=t,a=((e,t)=>!t._onlyDisableThirdParty||t._onlyDisableThirdParty!==e)(i,n);a||(yi(e,{integrationId:i}),vi(e))})(e,{integrationId:this.integrationId,urlParams:this.urlParams});break;case ci:((e,t)=>{const{integrationId:i,urlParams:n}=t,a=((e,t)=>!t._onlyEnableThirdParty||t._onlyEnableThirdParty===e)(i,n);a||(yi(e,{integrationId:i}),vi(e))})(e,{integrationId:this.integrationId,urlParams:this.urlParams});break;case gi:((e,t)=>{const{integrationId:i,integrationUrl:n}=t;(e=>!(!e.startsWith("https://")&&!e.startsWith("/")))(n)||(yi(e,{integrationId:i}),vi(e))})(e,{integrationId:this.integrationId,integrationUrl:this.integrationUrl});break;case pi:((e,t)=>{const{integrationId:i,integrationUrl:n,urlParams:a}=t,o=(e=>"resetCustom"!==e._mode&&("true"!==e._disableTPS||"true"===e._enableWIAPI)&&"true"!==e._disableWIAPI)(a);o||(yi(e,{integrationId:i,integrationUrl:n}),vi(e))})(e,{integrationId:this.integrationId,integrationUrl:this.integrationUrl,urlParams:this.urlParams})}}all(){this.reducer(mi),this.reducer(di),this.reducer(ci),this.reducer(gi),this.reducer(hi),this.reducer(pi),this.reducer(ui)}validate(e){this.reducer(e)}validateList(e){e.forEach((e=>{this.validate(e)}))}}const fi=q.onlyCoxIntegrations.split(",").map((e=>e.trim())),bi=async()=>{const e=await pt(),t=await j(),i=z(),n=Object.keys(e).reduce(((n,a)=>{const o=e[a];if(o&&o.fields&&o.fields.integrationUrl||o.urls){const{debugMode:r,fields:s,wiseIntegration:l}=o,{enabledDesktop:d,enabledSeamless:c,excludedPages:u}=s,{pageName:h,layoutType:p}=t;if(l){const{urls:g}=o,m=g.map((n=>new Promise((o=>{let{url:g}=n;const{types:m}=n;new wi(r,d,c,a,g,fi,p,i,l).all();let v=!1,y=!1,w=!1;if(u&&u.split(",").forEach((e=>{h.match(e)&&(y=!0)})),y||(Object.keys(s).forEach((e=>{(e.startsWith("addTo")||"includedPages"===e)&&(w=!0,s[e].split(",").forEach((e=>{("ALL"===e||h.match(e))&&(v=!0)})))})),v||w||(v=!0),!t.pageUrl.includes("cms.sales.apps.dealer.com")&&!t.pageUrl.includes("cms.sales.apps-np.dealer.com")||I.includes(a)||(v=!1)),v){Ot(a)&&(window.DDC.PrivateAPI.hasPrimaryPlaceholderIntegration=!0),ti(s),!g.startsWith("/")||g.startsWith("//")||g.startsWith("/static/")||(g=`/static${g}`);const t=ut(g)?ht(g,e[a].fields):g;ie(a,`Loading Integration JS: ${t}`),ri({integrationId:a,integrationType:"wise"},t,m.split(",").reduce(((e,t)=>{const[i,n]=t.split("=");return e.set(i,n),e}),new Map),!0)}else ie(a,`Config for ${a} found but excluded for the current page: ${h}.`);o(!0)}))));return[...n,...m]}{const t=new Promise((t=>{let{integrationUrl:n}=s;new wi(r,d,c,a,n,fi,p,i,l).all();let o=!1,g=!1,m=!1;if(u&&u.split(",").forEach((e=>{h.match(e)&&(g=!0)})),g||(Object.keys(s).forEach((e=>{(e.startsWith("addTo")||"includedPages"===e)&&(m=!0,s[e].split(",").forEach((e=>{("ALL"===e||h.match(e))&&(o=!0)})))})),o||m||(o=!0)),o){Ot(a)&&(window.DDC.PrivateAPI.hasPrimaryPlaceholderIntegration=!0),ti(s),!n.startsWith("/")||n.startsWith("//")||n.startsWith("/static/")||(n=`/static${n}`);const t=ut(n)?ht(n,e[a].fields):n;ie(a,`Loading Integration JS: ${t}`),ri({integrationId:a,integrationType:"api"},t,new Map,!0)}else ie(a,`Config for ${a} found but excluded for the current page: ${h}.`);t(!0)}));return[...n,t]}}return n}),[]);return await Promise.allSettled(n)},Pi=(e,t,i)=>{Be(e,"init"),(e=>{if(ze(e,"locationName"),!Je.includes(e))throw new Error(`Invalid location: ${e}. Valid options are: ${Je.join(", ")}.`)})(t),((e,t)=>{He(t,"Modifier");const{schema:i}=t;"schedule-service"===e&&(He(i,"Schema of the modifier object"),Ge(t,["schema"],`Modifier object of ${e}.`),Ge(i,["href","target","onclick","popover","attributes"],`the schema of the modifier object  of ${e}.`))})(t,i),Kt(e.integrationId,t,i);const{schema:n,callback:a}=i,o=Ve[t];return{apply:async()=>{await o.isReady();const i=await o.getElements();i&&i.forEach((i=>{switch(t){case"schedule-service":{const o=_e({init:e,location:t,schema:n,integrationCall:a},i,n,!1);J(o);break}}}))}}};class Ci{constructor(e){(e=>{if(ze(e,"event type"),!e.match(/.*-v\d+/))throw new Error(`Event types must end with a version (like -v1). Got: ${e}.`)})(e),this.eventType=e,this.fireEvent=this.fireEvent.bind(this),this.invoke=this.invoke.bind(this)}fireEvent(e){(e=>{if(!e.type)throw new Error("Events must have a type property.");const t={...e,timestamp:new Date};Qe.forEach(e.type,(e=>{Xe(e.init.integrationId,e.callback,t)})),Ye.push(e.type,t)})({type:this.eventType,...e})}invoke(){throw new Error("Event emitters should override invoke to fire events.")}}class Ii extends Ci{constructor(e){super(e),this.invokeOnce=this.invokeOnce.bind(this),this.invoked=!1}invoke(e){this.invoked||(this.invokeOnce(e),this.invoked=!0)}}const Di=()=>{const{dealership:e={},site:t={}}=window.DDC.dataLayer||{},i={};return e.dealerCode&&Array.isArray(e.dealerCode)&&e.dealerCode.forEach((e=>{Object.assign(i,e)})),{dealershipAddress1:e.address1||"",dealershipAddress2:e.address2||"",dealershipCity:e.city||"",dealershipCodes:i||[],dealershipCountry:e.country||"",dealershipFranchises:t.franchises||[],dealershipName:e.dealershipName||"",dealershipPostalCode:e.postalCode||"",dealershipStateProvince:e.stateProvince||""}};const Ei=e=>{const t=document.querySelector(".ws-inv-listing");t&&t.querySelectorAll(".loan-payment, .lease-payment").forEach((t=>{"hide"===e?t.classList.add("d-none"):"show"===e&&t.classList.remove("d-none")}));const i=document.querySelectorAll("#paymentLoan, #paymentLease");i&&i.forEach((t=>{"hide"===e?t.classList.add("d-none"):"show"===e&&t.classList.remove("d-none")}))},Ai=()=>{ei("hideDefaultPayments",!0),Ei("hide")},Li=()=>{ei("hideDefaultPayments",!1,!0),Ei("show")},Ti=async()=>{var e;const t=null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.siteSettings)||void 0===e?void 0:e.pageAlias;if(!t)return;const i=await Zt(t),n=(()=>{const e=JSON.parse(localStorage.getItem("userShowPayments"))||{};return null==e?void 0:e.show})();null!=i&&i.hideDefaultPayments||n?Ai():Li()};const Si="ddc-content web-api-added-placeholder hidden",$i=(e,t)=>W(`[data-location="${t}"]`,e)||W(`[data-location="${t}-custom"]`,e),ki=(e,t,i)=>{const n=document.createElement(e);return n.setAttribute(a,t),n.setAttribute("class","hidden"),i&&i.split(" ").forEach((e=>{n.classList.add(e)})),n},xi=(e,t,i)=>e.includes(t)?i:t,ji=(e,t)=>{e.parentNode.insertBefore(t,e.nextSibling)},Oi=(e,t)=>{e.parentNode.insertBefore(t,e)},Ui=(e,t)=>{e.appendChild(t)},Mi=()=>{const e=V(".ddc-vehicle-cta-summary");return e.length>0?e:V('[data-widget-name="ws-vehicle-ctas"]')},Ni=(e,t)=>{if(!$i(document,e)){const i=W(t);i&&i.setAttribute(a,e)}},Fi=new Map([["ASK","vehicle-ask-button"],["DRIVE","vehicle-drive-button"]]),Ri=async()=>{const e=W(".fixed-vdp-footer"),t=W(".links-list ul",e);return t&&(t.setAttribute("data-location","mobile-vdp-footer"),(async e=>{window.ldClient?(await window.ldClient.waitUntilReady(),e()):document.addEventListener("LDClientReady",e)})((async()=>{const t=window.ldClient.allFlags(),i=t["mobile-vdp-footer-delay"]||2e3,n=t["toggle-delay-vdp-footer"]||!1,a=await(async()=>{var e;return null!==(e=window.DDC)&&void 0!==e&&null!==(e=e.siteSettings)&&void 0!==e&&e.pageAlias&&(await Zt(window.DDC.siteSettings.pageAlias)).delayLoadVdpFooter||!1})()&&n;setTimeout((()=>{var t;null==e||null===(t=e.classList)||void 0===t||t.add("in")}),a?i:0)}))),!0},qi=async()=>{const e=await j(),t="data-target-locations";let i,n=[];var o,r;e.detailPage&&(i=W(".eprice-react-portal"),n=null!==(o=i)&&void 0!==o&&o.getAttribute(t)?null===(r=i)||void 0===r||null===(r=r.getAttribute(t))||void 0===r?void 0:r.split(" "):[]);return e.searchPage&&W(".inventory-listing-grid")?V(".gv-pricing").forEach((e=>{$i(e,g)||e.appendChild(ki("ul",g,"list-unstyled d-flex flex-column justify-content-center w-100")),$i(e,p)||e.appendChild(ki("div",p)),$i(e,v)||e.appendChild(ki("div",v)),$i(e,h)||e.appendChild(ki("ul",h,"list-unstyled d-flex flex-wrap justify-content-center"))})):(e.searchPage||e.detailPage)&&(await(async e=>{if(!$i(document,d)){const t=ki("div",d,Si);let i;e.detailPage?(i=W('[data-widget-id="tps-mediabot1"]')?W('[data-widget-id="tps-mediabot1"]'):W('[data-widget-name="ws-quick-specs"]'),i||(i=W('[data-widget-name="inventory-detail-highlighted-features"]'))):e.searchPage&&(i=W('[data-name="srp-wrapper-page-title"]')||W('[data-widget-name="inventory-listing-default"]')),i&&Oi(i,t)}return!0})(e),await(async(e,t)=>{if(!e.detailPage&&!e.searchPage)return!0;if(e.detailPage&&W('[data-widget-id="links-lead1"]')){const e=V('[data-widget-id="links-lead1"] .btn');e.length>0&&e.forEach((e=>{const t=e.getAttribute("data-link-label");t&&Fi.has(t)&&!e.getAttribute(a)&&e.setAttribute(a,Fi.get(t))}))}if(e.detailPage&&W('[data-widget-name="ws-vehicle-ctas"]')){const e=Mi(),i=xi(t,p,w);e.length>0&&e.forEach((e=>{e.setAttribute(a,i),V('[data-location~="vehicle-ctas"]',e).forEach((e=>{e.removeAttribute(a),e.classList.add("mb-3")}))}))}else{let t=[];if(e.searchPage)t=V(".pricing-area .pricing");else if(e.detailPage){const e=W(".inventory-detail-pricing .pricing");e&&t.push(e)}t.forEach((e=>{const t=document.createElement("li");t.setAttribute(a,p),t.setAttribute("class","web-api-added-placeholder hidden mt-3"),Ui(e,t)}))}return!0})(e,n),await(async(e,t)=>{if(e.detailPage){const e=xi(t,m,b);$i(document,e)||V('[data-widget-name="ws-detailed-pricing"]').forEach((t=>{const i=ki("div",e,`${Si} ws-detailed-pricing`);ji(t,i)}))}return!0})(e,n),await(async(e,t)=>{if(e.detailPage){const i=xi(t,p,w),n=xi(t,v,P),a=V(`[data-location="${i}"]`);if(a.length>0){const t=a[a.length-1],i="desktop"===e.layoutType?"ddc-content responsive-content-max-hide responsive-content-mid-hide responsive-content-min-hide box web-api-added-placeholder hidden":Si,o=ki(t.tagName.toLowerCase(),n,i);t.classList.add("pb-0"),ji(t,o)}}else e.searchPage&&V(".pricing-area .pricing").forEach((e=>{const t=ki("li",v,"web-api-added-placeholder hidden mb-4");Ui(e,t)}));return!0})(e,n),e.searchPage&&W(".inventoryList")?(V(".hproduct .media").forEach((e=>{$i(e,g)||e.appendChild(ki("ul",g,"list-unstyled d-flex flex-column"))})),V(".hproduct .calloutDetails ul").forEach((e=>{$i(e,h)||e.setAttribute(a,h)}))):e.detailPage&&((async(e,t)=>{const i=xi(t,g,f),n=xi(t,h,y);if(e.detailPage&&!$i(document,i)){const e=W('[data-widget-name="inventory-detail-highlighted-features"]');if(e){const t=ki("ul",i,"list-unstyled web-api-added-placeholder");Oi(e,t)}}Ni(n,".calloutDetails ul"),Ni(i,'.osiris-third-party-include [data-location="vehicle-media"]')})(e,n),await(async e=>{if(!e.detailPage)return!0;if(!$i(document,"secondary-content")){const e=ki("div","secondary-content",Si),t=W('[data-widget-id="detailed-specs1"]');t&&ji(t,e)}return!0})(e),await(async e=>!e.detailPage||(Mi().forEach(((e,t)=>{const i=e.getAttribute("data-location"),n=0===t?"top":"bottom";e.setAttribute("data-location",`${i} vehicle-ctas-${n}`)})),!0))(e),"mobile"===e.layoutType&&await Ri())),(async e=>{if(!e.pageName.includes("PRIVACY"))return!0;const t=W('[data-widget-name="privacy-form"]');if(t)return t.setAttribute("data-location","privacy-form"),!0;if(!$i(document,"privacy-form")){const e=ki("div","privacy-form",Si),t=W('[data-widget-id="content1"]');t&&ji(t,e)}})(e),!0},_i=[new class extends Ii{constructor(){super("page-load-v1")}async invokeOnce(){const e=await j();this.fireEvent({payload:e}),qt({exclude:"listings-"}),Nt.forEach((e=>{e.apply()}))}},new class extends Ii{constructor(){super("dealership-info-v1")}invokeOnce(){this.fireEvent({payload:Di()})}}],Wi=[new class extends Ci{constructor(){super("vehicle-data-updated-v1")}async invoke(){const e=await j(),t=await we();this.fireEvent({payload:{pageData:e,vehicleData:t}}),Ti()}}],Vi=[new class extends Ci{constructor(){super("vehicle-shown-v1")}async invoke(e){const t=await j(),i=await we(),n=async e=>{if(e){const t=i.filter((t=>t.uuid===e.uuid));if(t.length>0){const e=t[0];this.fireEvent({payload:e}),Ti()}}else i.forEach((e=>{this.fireEvent({payload:e}),Ti()}))};(t.searchPage||t.detailPage)&&(await ee(),(await G()&&e||!await G())&&await n(e))}}],Ji=async(e,t)=>(e.forEach((e=>{const i=Date.now();try{e.invoke(t);const n=Date.now();window.DDC.integrationLog(`Firing event emitter: ${e.eventType}`),Ct("event-emitter",e.eventType,n-i)}catch(t){const n=Date.now();Ct("event-emitter-failed",e.eventType,n-i),window.DDC.integrationLog(`Event emitter ${e.eventType} failed and took ${n-i}ms to fail.`,t)}})),!0),zi=async()=>(await qi(),await(async()=>{W("li.price-btn")&&V("li.price-btn").forEach((e=>{e.classList.add("clearfix")}));return!0})(),Ji(_i)),Hi=async()=>Ji(Wi),Gi=async e=>Ji(Vi,e),Bi={},Ki=async(e,t)=>{const i="getJwtForVehicles"===t?await be(e,"vin"):["false"];return fetch(`/api/ipp/jwt/vehicles?vins=${i.join()}`).then((i=>{if(!i.ok)throw $(e,{methodType:t,status:"Failed"}),new Error("Invalid response from the JWT endpoint.");return i.text().then((i=>{const n=(e=>{const t=e.split(".");if(t.length<2)return;const i=t[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(i).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(n)})(i);return $(e,{methodType:t,status:"Success"}),"getJwtForVehicles"===t?{vins:n.VINs,jwt:i}:{jwt:i}}))}))};class Yi{constructor(e){this.init=e}getIntegrationId(){return this.init.integrationId}getIntegrationType(){return this.init.integrationType}}class Qi extends Yi{constructor(e){super(),this.init=e}}const Xi=[{className:Yi,methods:{getAttributeForVehicles:be,getConfig:bt,getDealerData:e=>new Promise(((t,i)=>{const{dealership:n={}}=window.DDC.dataLayer||{};if(Object.keys(n).length>0)return $(e,{methodType:"getDealerData",status:"Success"}),void t(Di());$(e,{methodType:"getDealerData",status:"Failed"}),i(new Error("Unable to retrieve dealership data."))})),getJwtForSite:async e=>Ki(e,"getJwtForSite"),getJwtForVehicles:async e=>Ki(e,"getJwtForVehicles"),getPageData:async e=>{const t=await j();return $(e,{methodType:"getPageData",status:"object"==typeof t?"Success":"Failed"}),t},getPixallVisitorId:async()=>{const e=window.Cookies.get("pxa_id");return e||(await T("Pixall"),window.Pixall&&void 0!==window.Pixall.getVisitorId?window.Pixall.getVisitorId():new Error("No Pixall visitorId found"))},getSitemap:ft,getSiteProperties:wt,getUnlockedVehicles:async()=>{var e;const t=(null===(e=window)||void 0===e||null===(e=e.DDC)||void 0===e||null===(e=e.userProfile)||void 0===e?void 0:e.ePriceVehicles)||[];return[...new Set(t.map((e=>{var t;return null!==(t=null==e?void 0:e.itemUUID)&&void 0!==t?t:null})).filter((e=>e)))]},getUrlParams:z,getVehicleData:fe,unlockPricing:async(e,t)=>{var i;if(null===(i=window)||void 0===i||null===(i=i.DDC)||void 0===i||null===(i=i.userProfileController)||void 0===i||!i.saveInstantEpriceVehicle)return!1;let n=t;if(!n)try{n=await be(e,"uuid")}catch(e){return ie("Failed to unlock pricing:",e),!1}try{return await Promise.all(n.map((e=>(e=>new Promise((t=>{try{window.DDC.userProfileController.saveInstantEpriceVehicle(null,e)}catch(t){ie(`Failed to save vehicle with UUID ${e}:`,t)}t()})))(e)))),!0}catch(e){return ie("Failed to unlock pricing:",e),!1}}}},{className:Qi,methods:{getItemList:async(e,t)=>{const i=await j();if(!["inventory-badges","inventory-media"].includes(t))throw new Error(`The requested item list ${t} is not enabled for this API.`);if(!["item-list-badges"].includes(e.integrationId))throw new Error("The getItemList method is not allowed for use with this integration.");return i.searchPage||i.detailPage?(Bi[t]||(Bi[t]=(async(e,t,i)=>{try{const n=await fetch(t,{headers:{Accept:"application/json"}});if(!n.ok)throw e.integrationId&&$(e,{methodType:i,status:"Failed"}),new Error(`Error calling the endpoint at ${t}.`);return e.integrationId&&$(e,{methodType:i,status:"Success"}),0===n.size?{}:await n.json()}catch(e){throw new Error(`Error fetching JSON: ${e.message}`)}})(e,`/api/badge-item-lists/${t}`,"getItemList")),Bi[t]):[]},getSettings:Zt,hideDefaultPayments:Ai,showDefaultPayments:Li}}];var Zi;Xi.forEach((e=>{const t=e;Object.entries(t.methods).forEach((e=>{let[i,n]=e;t.className.prototype[i]=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];const o={integrationId:this.getIntegrationId(),integrationType:this.getIntegrationType()};return"getUrlParams"===i?n.call(null,o,...t):new Promise(((e,i)=>{try{e(n.call(null,o,...t))}catch(e){i(e)}}))}}))}));const en={append:se,create:(e,t,i)=>($(e,{methodType:"Create",type:t,...i}),"button"===t?_e(e,document.createElement("a"),i):null),insert:Wt,insertOnce:async(e,t,i)=>Wt(e,t,i,!1),insertCallToAction:Vt,insertCallToActionOnce:async(e,t,i,n)=>Vt(e,t,i,n,!1),insertGalleryContent:async(e,t,i)=>{try{ot(t);const n=Array.isArray(i)?i:[i];if("vehicle-media"===t){const t=await fe();dt(e,n,t)}return e&&$(e,{methodType:"insertGalleryContent",location:t}),Promise.resolve()}catch(e){return Promise.reject(e)}},insertMenuContent:async(e,t,i)=>{(e=>{if(!zt.includes(e))throw new Error(`Unsupported device type: '${e}'. Expected one of: ${zt.join(", ")}.`)})((await j()).layoutType);const n=!!document.querySelector('a[data-href="/fragments/ws-nav-mobile.htm"], a[data-href="/navigation-fragments/search-navigation-and-contact.htm"]');n&&document.querySelectorAll('#ddc-mobile-header-nav[data-location="primary-menu primary-menu-top primary-menu-bottom"]').forEach((e=>{e.removeAttribute("data-location")}));const a=Array.isArray(i)?i:[i];return(e=>{if(!Gt.includes(e))throw new Error(`Unsupported menu target: '${e}'. Expected one of: ${Gt.join(", ")}.`)})(t),await E(),a.forEach((i=>{const{position:a,callback:o}=i;(e=>{if(!Ht.includes(e))throw new Error(`Unsupported menu position: '${e}'. Expected one of: ${Ht.join(", ")}.`)})(a);const r=`${t}-${a}`;Wt(e,r,((t,a)=>{for(;t.hasChildNodes();)t.removeChild(t.firstChild);const r=(e=>{const{primaryText:t,secondaryText:i,expanded:n,menuIcon:a,subItems:o,position:r,onclick:s,isFragmentNavType:l=!0}=e,d=l?"fragment":"header";if(!t)return ie("Required primaryText field is missing."),!1;if(!o||0===o.length){const t=`\n\t\t\t<div class="panel-heading">\n\t\t\t\t<div class="panel-title">\n\t\t\t\t\t<a data-navigation-id="default" class="panel-heading-link accordion-faux collapsed" href="${e.href}" data-iconpos="left">\n\t\t\t\t\t\t<i class="icon-blank"></i>\n\t\t\t\t\t\t<span>${e.primaryText}</span>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,i=ct(t);return s&&i.querySelector("a").addEventListener("click",s),i}const c=n?" in":"",u=n?"":" collapsed",h=document.createElement("div"),p=i?`<span class='subtext'>${i}</span>`:"";let g=ct(`\n\t\t<div class="panel-heading">\n\t\t\t<div class="panel-title">\n\t\t\t\t<div class="row py-3">\n\t\t\t\t\t${a?'<div class="ddc-span2"><i class="ddc-icon ddc-icon-mycars-login-circle ddc-icon-size-xxlarge"></i></div>':""}\n\t\t\t\t\t<div class="${a?"ddc-span10":"ddc-span12"} pt-3 pb-2">\n\t\t\t\t\t\t<p class="m-0">\n\t\t\t\t\t\t\t<a data-navigation-id="default" href="#" class="no-follow panel-heading-link panel-toggle${u} p-0"\n\t\t\t\t\t\t\tdata-toggle="collapse" data-target="#ddc-fragment-accordion-nav-wiapi-${r}" aria-expanded="false"\n\t\t\t\t\t\t\tui-tabs-initial-load="false" rel="nofollow">\n\t\t\t\t\t\t\t\t<i class="ddc-icon ddc-icon-size-small ddc-icon-plus"></i>\n\t\t\t\t\t\t\t\t<span class="ddc-font-size-large font-weight-bold">${t}</span></a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p class="ddc-font-size-small">${p}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`);l||(g=ct(`\n\t\t\t<div class="panel-heading">\n\t\t\t\t<div class="panel-title">\n\t\t\t\t\t<a data-navigation-id="default" href="#" class="no-follow panel-heading-link panel-toggle${u}"\n\t\t\t\t\tdata-toggle="collapse" data-target="#ddc-header-accordion-nav-wiapi-${r}" aria-expanded="false"\n\t\t\t\t\tui-tabs-initial-load="false" rel="nofollow">\n\t\t\t\t\t\t<div class="pt-2 pb-6">\n\t\t\t\t\t\t\t${a?'<div class="ddc-span1"><i class="ddc-icon ddc-icon-mycars-login-circle ddc-icon-size-xxlarge"></i></div>':""}\n\t\t\t\t\t\t\t<i class="ddc-icon ddc-icon-size-small ddc-icon-plus"></i>\n\t\t\t\t\t\t\t<div class="${a?"ddc-span10":"ddc-span11"}">\n\t\t\t\t\t\t\t\t<span class="ddc-font-size-large font-weight-bold">${t}</span>\n\t\t\t\t\t\t\t\t<p class="ddc-font-size-small">${p}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`));if(h.appendChild(g),!(null!=e&&e.secondaryText||null!=e&&e.subItems))return h;const m=document.createElement("ul");m.classList.add(`ddc-mobile-${d}-sub-nav`,"list-unstyled"),null!=e&&e.subItems&&e.subItems.forEach((e=>{const t=document.createElement("li"),i=document.createElement("a");i.setAttribute("data-navigation-id","default"),i.classList.add("nav-link","tier3"),i.href=e.href,i.textContent=e.text,"function"==typeof e.onclick&&i.addEventListener("click",e.onclick),t.appendChild(i),m.appendChild(t)}));const v=ct(`\n\t\t<div id="ddc-${d}-accordion-nav-wiapi-${r}" class="panel-collapse collapse${c}" aria-expanded="true" style="">\n\t\t\t<div class="panel-body">\n\t\t\t</div>\n\t\t</div>\n\t`);return v.querySelector(".panel-body").appendChild(m),h.appendChild(v),h})({...i,isFragmentNavType:n});if(!r)return;const s=se(e,t,r);o&&o(s,a,i)}),!0),$(e,{methodType:"insertMenuContent",location:r})})),!0},update:Jt,updateOnce:async(e,t,i)=>Jt(e,t,i,!1),updateLink:async function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=()=>_t("updateLink",l,e,null,"links",t,i,n),o=a();try{const n="mobile"===(await j()).layoutType;n&&(await E(),await(async(e,t)=>{if(!document.querySelector('a[data-href*="/navigation-fragments/"], a[data-href*="/fragments/"]'))return void ie("[FRAGMENT_WAIT] No hamburger menu with fragment navigation found, skipping wait");const i=!!document.querySelector('[data-location~="primary-menu"]');let n;n=i?await D(".fragment-content"):await D(".ddc-mobile-fragment-nav");let a=[];try{const{getContentMappings:i}=await Promise.resolve().then((function(){return Pt})),n=(await i(t)).links||{};a=n[e]||[]}catch(e){ie("[FRAGMENT_WAIT] Error getting content mappings:",e)}const o=()=>{if(a.length>0){if(a.map((e=>`a[href^="${e}"]`)).some((e=>null!==n.querySelector(e))))return!0}else if(null!==n.querySelector("a"))return!0;return!1};o()||await new Promise((e=>{const t=new MutationObserver((()=>{o()&&(t.disconnect(),e())}));t.observe(n,{childList:!0,subtree:!0,attributes:!1}),o()&&(t.disconnect(),e())}))})(t,e),a(),((e,t)=>{const i=document.querySelector(`[data-mobile-override="${e}"]`);i&&i.remove(),document.addEventListener("click",(e=>{const i=e.target.closest("a");if(i&&i.getAttribute("href")&&(i.closest(".ddc-mobile-header-nav")||i.closest('[data-location~="primary-menu"]')||i.closest(".mobile-menu")||i.closest(".ddc-mobile-header-sub-nav")||i.closest("#ddc-mobile-header-nav"))&&i.dataset.wiapiProcessed){e.preventDefault(),e.stopPropagation();try{const e=t();e&&"object"==typeof e&&"function"==typeof e.onclick&&e.onclick()}catch(e){ie("[MOBILE_OVERRIDE] Error executing callback:",e)}}}),{capture:!0});const n=document.createElement("div");n.setAttribute("data-mobile-override",e),n.style.display="none",document.body.appendChild(n),ie("[MOBILE_OVERRIDE] Added mobile menu override for intent:",e)})(t,i))}catch(e){ie("Could not determine layout type, proceeding with standard link update:",e)}return o},modifyContent:(e,t,i)=>{Pi(e,t,i).apply(),$(e,{methodType:"modifyContent",location:t})},load:oi,loadJS:ri,loadCSS:async(e,t)=>oi(e,t,"css"),log:ie,subscribe:(e,t,i)=>{Be(e,"init"),ze(t,"eventType");const n=new Ke(e,i);Qe.push(t,n),Ye.forEach(t,(t=>{Xe(e.integrationId,i,t)})),$(e,{subscribedEvent:t})},test:(e,t)=>{const i="string"==typeof e?e:e.integrationId;return i&&t&&((e,t,i)=>{let n;if(i){const e=new Date;e.setTime(e.getTime()+24*i*60*60*1e3),n=`; expires=${e.toGMTString()}`}else n="";document.cookie=`${e}=${t}${n}; path=/`})("WebIntegrationAPITestLoader",`${i}|${t}`),void 0!==ai._integrationMode&&oi(e,t)}},tn=class{constructor(i){let n,a;const o=document.currentScript&&"function"==typeof document.currentScript.getAttribute&&""!==document.currentScript.getAttribute("data-web-api-id")?document.currentScript:i;o&&"object"==typeof o&&("function"==typeof o.getAttribute&&""!==o.getAttribute("data-web-api-id")?(n=o.getAttribute("data-web-api-id"),a=o.getAttribute("data-web-api-type")||""):({integrationId:n,integrationType:a}=o)),!n&&i&&""!==i&&(n=i,a=i),ze(n,"integrationId"),this.init={integrationId:e(n),integrationType:t(a)},this.utils=new Yi(this.init),this.privateUtils=new Qi(this.init)}};Object.entries(en).forEach((e=>{let[t,i]=e;tn.prototype[t]=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return oe&&"log"!==t&&ie(`${this.init.integrationId} called ${t}:`,...n),i.call(null,this.init,...n)}}));const{DDC:nn}=window||{};nn.API=tn,nn.PrivateAPI=nn.PrivateAPI||{},nn.PrivateAPI={...nn.PrivateAPI,notifyDynamicContent:()=>{zi(),si("all")},notifyInventoryContent:e=>{e?Gi(e):Hi()},timings:{},content:{},getGalleryContent:(e,t)=>(ot(e),nt[e][t]),getAllGalleryContent:e=>(ot(e),nt[e]),getPageLevelModifications:e=>e?Bt[e]:Bt,integrationsLoaded:!1,track:$,inventoryData:null};const an=()=>{(async()=>{var e;await A(),null!=nn&&null!==(e=nn.userProfileController)&&void 0!==e&&e.loadProfile&&nn.userProfileController.loadProfile()})(),(async()=>{window.dispatchEvent(new Event("WIAPIReady")),await bi(),window.DDC.PrivateAPI.integrationsLoaded=!0,window.dispatchEvent(new Event("WIAPILoaded"))})()};null!==(Zi=window.DDC)&&void 0!==Zi&&Zi.apiLoaderInstance?an():window.addEventListener("WIAPILoaderReady",an,{once:!0});let on=!1;const rn=async()=>(_.forEach((e=>{e.disconnect(),_.delete(e)})),Rt.clear(),window.DDC.PrivateAPI.inventoryData={},await we(),!0),sn=(e,t)=>{const i=async i=>{try{await t(i)}catch(t){ie(e,`Error in event handler: ${t}`)}};window.DDC&&window.DDC.pubsub?window.DDC.pubsub.subscribe(e,i):window.addEventListener(e,i)},ln=e=>{return!e||e.length<32||(Gi({uuid:e}),t={uuid:e},Rt.forEach((e=>{e.apply(t,!0)})),Ft.forEach((e=>{e.apply(t,!0)}))),!0;var t},dn=e=>(qt({include:e}),!0),cn=e=>{const{id:t,isLocation:i}=e.detail;i?dn(t):ln(t)},un=async()=>(window.DDC.PrivateAPI=window.DDC.PrivateAPI||{},window.DDC.PrivateAPI.inventoryData={},await rn(),await Hi(),await(async()=>{var e;return null!==(e=window)&&void 0!==e&&null!==(e=e.DDC)&&void 0!==e&&null!==(e=e.APIEvents)&&void 0!==e&&e.get&&(window.DDC.APIEvents.get().forEach((e=>{cn(e)})),window.DDC.APIEvents.received=[]),window.addEventListener("wsInvListingShown",(e=>{cn(e)})),window.addEventListener("wiapiPlaceholderAvailable",(e=>{dn(e.detail.location)})),dn("listings-")})(),!0),hn=async()=>{await zi();const e=await j();if(null!=e&&e.searchPage||null!=e&&e.detailPage)if(await ee(),await G()){var t;const e=async()=>{if(on)return!0;on=!0;let e=null,t=window.innerWidth,i=0;const n=()=>{const n=W("#card-layout-toggle-portal button.active .ddc-icon");if(!n)return;(n=>{clearTimeout(e),i=window.innerWidth,e=setTimeout((async()=>{(i<=n&&t>=n||i>=n&&t<=n)&&(t=window.innerWidth,un())}),500)})(n.classList.contains("ddc-icon-layout-grid")?1440:768)};return window.addEventListener("resize",n,!1),n(),await un(),sn("ws-inv-data/inventory",un),window.DDC.InvData.registerToggleListingView((async()=>{await un(),document.querySelectorAll("[data-uuid]").forEach((e=>{const t=e.getAttribute("data-uuid");cn({detail:{id:t,isLocation:!1}})}))})),!0};null!==(t=window.DDC)&&void 0!==t&&null!==(t=t.PrivateAPI)&&void 0!==t&&t.wsInvListingRendered?await e():sn("ws-inv-listing-update",e)}else await Hi(),await Gi()};(async()=>{await A(),hn()})(),window.addEventListener("DOMContentLoaded",(()=>{si("css"),si("js")})),window.addEventListener("load",(()=>{si("all")}))}));
//# sourceMappingURL=lib.js.map

}